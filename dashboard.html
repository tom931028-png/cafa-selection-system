<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¸èª²ä¸»ç³»çµ± | CAFA Student</title>
    <style>
        /* --- ç©ºè»ä¸»é¡Œè‰²ç³» --- */
        :root { --cafa-blue-dark: #002266; --cafa-blue-main: #00308F; --cafa-blue-light: #4a7bd1; --cafa-gold: #FFD700; --bg-grey: #f0f2f5; }
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; margin: 0; background-color: var(--bg-grey); color: #333; display: flex; height: 100vh; overflow: hidden; }
        
        /* å´é‚Šæ¬„ */
        .sidebar { width: 260px; background: linear-gradient(180deg, var(--cafa-blue-main) 0%, var(--cafa-blue-dark) 100%); color: white; display: flex; flex-direction: column; padding-top: 25px; box-shadow: 4px 0 15px rgba(0,0,0,0.1); position: relative; overflow: hidden; }
        .sidebar::after { content: 'âœˆ'; position: absolute; bottom: -50px; right: -50px; font-size: 200px; color: rgba(255,255,255,0.05); transform: rotate(-20deg); pointer-events: none; }
        .sidebar-header { text-align: center; padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 20px; }
        .menu-item { padding: 15px 30px; cursor: pointer; transition: 0.3s; color: rgba(255,255,255,0.8); display: flex; align-items: center; }
        .menu-item:hover { background: rgba(255,255,255,0.1); color: white; }
        .menu-item.active { background: rgba(0,0,0,0.2); border-left: 4px solid var(--cafa-gold); color: white; font-weight: bold; }
        .menu-item span { margin-right: 12px; font-size: 18px; }
        .student-info { margin-top: auto; padding: 25px; background: rgba(0,0,0,0.25); font-size: 14px; border-top: 1px solid rgba(255,255,255,0.1); line-height: 1.6; }

        /* ä¸»å…§å®¹ */
        .main-content { flex: 1; padding: 30px; overflow-y: auto; background-image: linear-gradient(to bottom, #eef2f7, #f4f7fa); }
        .header-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; background: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .header-title { font-size: 24px; font-weight: bold; color: var(--cafa-blue-main); border-left: 8px solid var(--cafa-gold); padding-left: 15px; }
        .card { background: white; border-radius: 12px; padding: 25px; margin-bottom: 25px; border-top: 3px solid var(--cafa-blue-light); box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        
        /* è¡¨æ ¼èˆ‡æ¨™ç±¤ */
        table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 14px; }
        th { background: #f8f9fa; color: var(--cafa-blue-dark); padding: 15px; text-align: left; border-bottom: 2px solid var(--cafa-blue-main); }
        td { padding: 15px; border-bottom: 1px solid #eee; }
        .tag { padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: bold; }
        .tag-compulsory { background: #e3f2fd; color: #0d47a1; } .tag-elective { background: #e8f5e9; color: #1b5e20; } .tag-fixed { background: #fff3e0; color: #e65100; border: 1px solid #ffe0b2; }
        
        .btn { padding: 8px 16px; border-radius: 30px; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn:hover { transform: translateY(-1px); }
        .btn-add { background: #28a745; color: white; } .btn-drop { background: #dc3545; color: white; } 
        .btn-save { background: var(--cafa-blue-main); color: white; width: 100%; padding: 12px; margin-top:20px; }
        .btn-disabled { background: #e9ecef; cursor: not-allowed; color: #adb5bd; }

        /* è·æ¶¯é é¢æ¨£å¼ */
        .career-option { display: flex; gap: 20px; margin-bottom: 20px; }
        .radio-card { flex: 1; border: 2px solid #eee; padding: 20px; border-radius: 10px; cursor: pointer; text-align: center; transition: 0.3s; }
        .radio-card:hover { border-color: var(--cafa-blue-light); background: #f0f7ff; }
        .radio-card.selected { border-color: var(--cafa-blue-main); background: #e3f2fd; box-shadow: 0 0 0 2px var(--cafa-blue-main); }
        .interest-tags { margin-top: 15px; display: flex; gap: 10px; flex-wrap: wrap; }
        .interest-check { display: none; }
        .interest-label { padding: 8px 16px; background: #eee; border-radius: 20px; cursor: pointer; user-select: none; transition: 0.2s; }
        .interest-check:checked + .interest-label { background: var(--cafa-gold); color: black; font-weight: bold; transform: scale(1.05); }

        /* èª²è¡¨æ ¼å­ */
        .schedule-table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        .schedule-table th { text-align: center; background: #f8f9fa; border: 1px solid #ddd; }
        .schedule-table td { height: 60px; border: 1px solid #eee; padding: 5px; vertical-align: top; text-align: center; }
        .course-block { padding: 5px; border-radius: 4px; color: white; font-size: 12px; margin-bottom: 2px; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .block-fixed { background: linear-gradient(135deg, #e65100, #ff9800); }
        .block-normal { background: linear-gradient(135deg, var(--cafa-blue-main), var(--cafa-blue-light)); }

        /* AI æ‡¸æµ®è¦–çª— */
        .ai-fab { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background: linear-gradient(135deg, #00308F, #0055ff); color: white; border-radius: 50%; box-shadow: 0 4px 15px rgba(0,0,0,0.3); display: flex; justify-content: center; align-items: center; font-size: 30px; cursor: pointer; z-index: 1000; transition: transform 0.3s; }
        .ai-fab:hover { transform: scale(1.1); }
        .chat-window { position: fixed; bottom: 100px; right: 30px; width: 350px; height: 500px; background: white; border-radius: 12px; box-shadow: 0 5px 25px rgba(0,0,0,0.2); display: none; flex-direction: column; overflow: hidden; z-index: 1000; border: 1px solid #ddd; }
        .chat-header { background: var(--cafa-blue-main); color: white; padding: 15px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
        .chat-body { flex: 1; padding: 15px; overflow-y: auto; background: #f9f9f9; display: flex; flex-direction: column; gap: 10px; }
        .chat-input-area { padding: 10px; border-top: 1px solid #eee; display: flex; gap: 10px; background: white; }
        .chat-input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 20px; outline: none; }
        .chat-send { background: var(--cafa-blue-main); color: white; border: none; padding: 0 15px; border-radius: 20px; cursor: pointer; }
        .msg { padding: 8px 12px; border-radius: 12px; max-width: 80%; font-size: 14px; line-height: 1.4; }
        .msg-ai { background: white; border: 1px solid #ddd; align-self: flex-start; }
        .msg-user { background: var(--cafa-blue-main); color: white; align-self: flex-end; }
        
        #loading { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(255,255,255,0.95); display: flex; justify-content: center; align-items: center; z-index: 999; flex-direction: column; color: var(--cafa-blue-main); }
    </style>
</head>
<body>
    <div id="loading">
        <div style="font-size:40px; margin-bottom:10px;">â˜ï¸</div>
        <div>ç­ç´šèª²è¡¨åŒæ­¥ä¸­...</div>
    </div>
    
    <div class="sidebar">
        <div class="sidebar-header">
            <h2 style="margin:0;">âœˆï¸ CAFA</h2>
            <p style="margin:5px 0 0 0; font-size:12px; opacity:0.8;">Student Portal</p>
        </div>
        <div class="menu-item active" onclick="switchTab('selection')"><span>ğŸ›’</span> åŠ é€€é¸èª²ç¨‹</div>
        <div class="menu-item" onclick="switchTab('schedule')"><span>ğŸ“…</span> å·²é¸æ¸…å–®</div>
        <div class="menu-item" onclick="switchTab('visual')"><span>ğŸ“Š</span> å¯è¦–åŒ–èª²è¡¨</div>
        <div class="menu-item" onclick="switchTab('career')"><span>ğŸ¯</span> è·æ¶¯èˆ‡æ¨è–¦</div>
        <div class="menu-item" onclick="switchTab('history')"><span>ğŸ“ˆ</span> æ­·å¹´æˆç¸¾</div>
        <div class="menu-item" onclick="logout()" style="margin-top:auto"><span>ğŸšª</span> ç™»å‡ºç³»çµ±</div>
        
        <div class="student-info" id="user-info-box">è¼‰å…¥ä¸­...</div>
    </div>

    <div class="main-content">
        <div id="selection-view">
            <div class="header-bar">
                <div class="header-title">é–‹æ”¾é¸èª²æ¸…å–®</div>
                <span style="font-weight:bold; color:var(--cafa-blue-main)">ç›®å‰å·²é¸å­¸åˆ†ï¼š<span id="current-credits">0</span></span>
            </div>
            <div class="card"><table style="width:100%"><thead><tr><th>å±¬æ€§</th><th>èª²è™Ÿ</th><th>èª²ç¨‹åç¨±</th><th>å­¸åˆ†</th><th>æ™‚é–“</th><th>ç‹€æ…‹</th><th>æ“ä½œ</th></tr></thead><tbody id="course-list-body"></tbody></table></div>
        </div>

        <div id="schedule-view" style="display:none">
            <div class="header-bar"><div class="header-title">æˆ‘çš„å·²é¸èª²ç¨‹</div></div>
            <div class="card"><table style="width:100%"><thead><tr><th>å±¬æ€§</th><th>èª²ç¨‹åç¨±</th><th>å­¸åˆ†</th><th>æ™‚é–“</th><th>åœ°é»</th><th>æ“ä½œ</th></tr></thead><tbody id="my-course-body"></tbody></table></div>
        </div>

        <div id="visual-view" style="display:none">
            <div class="header-bar"><div class="header-title">é€±èª²è¡¨æª¢è¦–</div><button class="btn btn-save" style="width:auto; margin:0;" onclick="window.print()">ğŸ–¨ï¸ åˆ—å°</button></div>
            <div class="card"><table class="schedule-table"><thead><tr><th style="width:60px;">ç¯€æ¬¡</th><th>ä¸€</th><th>äºŒ</th><th>ä¸‰</th><th>å››</th><th>äº”</th></tr></thead><tbody id="visual-schedule-body"></tbody></table></div>
        </div>

        <div id="career-view" style="display:none">
            <div class="header-bar"><div class="header-title">è·æ¶¯è¦åŠƒèˆ‡æ¨è–¦</div></div>
            <div class="card">
                <h3>1. æœªä¾†ç™¼å±•æ–¹å‘</h3>
                <div class="career-option">
                    <div class="radio-card" id="track-pilot" onclick="selectTrack('pilot')">
                        <div style="font-size:30px;">ğŸ¦…</div><h3>é£›è¡Œç”Ÿ</h3>
                    </div>
                    <div class="radio-card" id="track-ground" onclick="selectTrack('ground')">
                        <div style="font-size:30px;">ğŸ› ï¸</div><h3>åœ°å‹¤ç”Ÿ</h3>
                    </div>
                </div>
                <h3>2. èˆˆè¶£æ¨™ç±¤</h3>
                <div class="interest-tags">
                    <input type="checkbox" id="i1" class="interest-check" value="ç†å·¥"><label for="i1" class="interest-label">ğŸ“ ç†å·¥æ•¸ç†</label>
                    <input type="checkbox" id="i2" class="interest-check" value="è³‡é›»"><label for="i2" class="interest-label">ğŸ’» è³‡è¨Šé›»å­</label>
                    <input type="checkbox" id="i3" class="interest-check" value="å¤–èª"><label for="i3" class="interest-label">ğŸŒ å¤–èªèƒ½åŠ›</label>
                    <input type="checkbox" id="i4" class="interest-check" value="é«”èƒ½"><label for="i4" class="interest-label">ğŸ’ª é«”èƒ½ç«¶æŠ€</label>
                    <input type="checkbox" id="i5" class="interest-check" value="ç®¡ç†"><label for="i5" class="interest-label">ğŸ›¡ï¸ é ˜å°ç®¡ç†</label>
                </div>
                <button class="btn btn-save" onclick="saveCareer()">ğŸ’¾ å„²å­˜ä¸¦ç”¢ç”Ÿæ¨è–¦</button>
            </div>
            <div class="card">
                <h3>â­ å°ˆå±¬èª²ç¨‹æ¨è–¦</h3>
                <div id="rec-list" style="padding:10px; color:#666;">(è«‹å…ˆè¨­å®šè·æ¶¯èˆ‡èˆˆè¶£)</div>
            </div>
        </div>

        <div id="history-view" style="display:none">
            <div class="header-bar"><div class="header-title">æ­·å¹´æˆç¸¾</div></div>
            <div class="card" id="history-content"></div>
        </div>
    </div>

    <div class="ai-fab" onclick="toggleChat()">ğŸ¤–</div>
    <div class="chat-window" id="chat-window">
        <div class="chat-header">ğŸ¤– èª²å‹™å°å¹«æ‰‹ <span style="cursor:pointer" onclick="toggleChat()">âœ–</span></div>
        <div class="chat-body" id="chat-body"><div class="msg msg-ai">åŒå­¸ä½ å¥½ï¼æˆ‘æ˜¯é¸èª² AIï¼Œæœ‰ä»€éº¼å¯ä»¥å¹«ä½ çš„å—ï¼Ÿ(ä¾‹å¦‚ï¼šæ€éº¼é¸èª²ã€å¿…ä¿®å¯ä»¥é€€å—)</div></div>
        <div class="chat-input-area">
            <input type="text" class="chat-input" id="chat-input" placeholder="è¼¸å…¥å•é¡Œ..." onkeypress="if(event.key==='Enter')sendMessage()">
            <button class="chat-send" onclick="sendMessage()">â¤</button>
        </div>
    </div>

    <script type="module">
        import { loadFromCloud, saveToCloud } from './firebase-connect.js';
        const KEYS = { STUDENTS: 'cafa_all_students_db', FIXED: 'cafa_fixed_courses', ELECTIVE: 'cafa_public_electives' };
        let allCourses=[], myCourses=[], currentUser=null, studentDB=[], selectedTrack=null;

        window.onload = async function() {
            const u = sessionStorage.getItem('cafa_user');
            if(!u) { window.location.href='index.html'; return; }
            currentUser = JSON.parse(u);
            
            // é¡¯ç¤ºå€‹äººè³‡è¨Š (åŒ…å«ç­ç´š)
            document.getElementById('user-info-box').innerHTML = `
                <div style="font-size:16px; font-weight:bold; margin-bottom:5px;">${currentUser.name}</div>
                <div>ç­ç´šï¼š${currentUser.classId || currentUser.dept || 'æœªåˆ†ç­'}</div>
                <div>å­¸è™Ÿï¼š${currentUser.id}</div>
            `;

            document.getElementById('loading').style.display='flex';
            await syncData();
            document.getElementById('loading').style.display='none';
            
            // è¼‰å…¥è·æ¶¯è¨­å®š
            if(currentUser.careerTrack) selectTrack(currentUser.careerTrack);
            if(currentUser.interests) currentUser.interests.forEach(v => {
                const cb = document.querySelector(`.interest-check[value="${v}"]`);
                if(cb) cb.checked = true;
            });
            genRec();
        };
        
        // ç¶å®šå…¨åŸŸåŠŸèƒ½
        window.logout = () => { sessionStorage.removeItem('cafa_user'); window.location.href='index.html'; };
        window.switchTab = switchTab; window.add = add; window.drop = drop; 
        window.selectTrack = selectTrack; window.saveCareer = saveCareer; 
        window.toggleChat = toggleChat; window.sendMessage = sendMessage;

        async function syncData() {
            // 1. ä¸‹è¼‰æœ€æ–°è³‡æ–™
            studentDB = (await loadFromCloud(KEYS.STUDENTS)) || [];
            const me = studentDB.find(s => s.id === currentUser.id);
            if(me) { 
                currentUser = me; 
                myCourses = me.courses || []; // é€™è£¡æœƒè‡ªå‹•åŒæ­¥å°å¸«çŒå…¥çš„å¿…ä¿®èª²
            }

            allCourses = [];
            const el = (await loadFromCloud(KEYS.ELECTIVE))||[]; 
            el.forEach(c=>{c.capacity=50;c.enrolled=0;allCourses.push(c)});
            
            // 2. æ¸²æŸ“ç•«é¢
            render();
        }

        async function saveMyData() {
            const idx = studentDB.findIndex(s => s.id === currentUser.id);
            if(idx > -1) {
                studentDB[idx].courses = myCourses;
                studentDB[idx].totalCredits = myCourses.reduce((a,b)=>a+b.credit,0);
                // åŒæ­¥è·æ¶¯
                studentDB[idx].careerTrack = selectedTrack;
                // æ›´æ–° current
                currentUser = studentDB[idx];
                await saveToCloud(KEYS.STUDENTS, studentDB);
            }
        }

        function render() {
            // 1. é¸èª²åˆ—è¡¨
            const tb = document.getElementById('course-list-body'); tb.innerHTML='';
            allCourses.forEach(c => {
                const has = myCourses.some(m => m.id === c.id);
                const open = c.isOpen !== false;
                let btn = '';
                if(has) btn = `<button class="btn btn-disabled" disabled>å·²é¸</button>`;
                else if(!open) btn = `<button class="btn btn-disabled" disabled>æš«åœ</button>`;
                else btn = `<button class="btn btn-add" onclick="add('${c.id}')">åŠ é¸</button>`;

                tb.innerHTML+=`<tr><td><span class="tag tag-elective">é¸ä¿®</span></td><td>${c.id}</td><td>${c.name}</td><td>${c.credit}</td><td>${c.time}</td><td>${c.enrolled}/${c.capacity}</td><td>${btn}</td></tr>`;
            });

            // 2. å·²é¸åˆ—è¡¨
            const mtb = document.getElementById('my-course-body'); mtb.innerHTML='';
            myCourses.forEach(c => {
                // æª¢æŸ¥æ˜¯å¦ç‚ºå›ºå®šå¿…ä¿® (å°å¸«çŒæª”çš„ isFixed=true)
                let lock = c.isFixed === true;
                mtb.innerHTML+=`<tr><td><span class="tag ${lock?'tag-fixed':'tag-elective'}">${lock?'å¿…ä¿®':'é¸ä¿®'}</span></td><td>${c.name}</td><td>${c.credit}</td><td>${c.time}</td><td>${c.location||''}</td><td>${lock?'<span style="color:#e65100;font-weight:bold;font-size:12px;">ğŸ”’ ç­å®š</span>':`<button class="btn btn-drop" onclick="drop('${c.id}')">é€€é¸</button>`}</td></tr>`;
            });

            document.getElementById('current-credits').innerText = myCourses.reduce((a,b)=>a+b.credit,0);
            
            // 3. èª²è¡¨èˆ‡æˆç¸¾
            renderGrid();
            renderHistory();
        }

        async function add(id) {
            const c = allCourses.find(x=>x.id===id);
            const conflict = checkConflict(c);
            if(conflict) return alert(`âŒ åŠ é¸å¤±æ•—ï¼èˆ‡å¿…ä¿®/å·²é¸èª²ç¨‹ã€${conflict}ã€‘è¡å ‚ã€‚`);
            myCourses.push(c); await saveMyData(); render(); alert(`âœ… åŠ é¸æˆåŠŸï¼š${c.name}`);
        }

        async function drop(id) {
            const c = myCourses.find(x=>x.id===id);
            if(c && c.isFixed) return alert("âš ï¸ é€™æ˜¯ç­å®šå¿…ä¿®ï¼Œç„¡æ³•é€€é¸ï¼");
            if(confirm("ç¢ºå®šé€€é¸ï¼Ÿ")) { myCourses=myCourses.filter(x=>x.id!==id); await saveMyData(); render(); }
        }

        // è¡å ‚æª¢æŸ¥ (åŒ…å«å°å¸«çŒå…¥çš„å¿…ä¿®)
        function checkConflict(nc) {
            if(!nc.time) return null;
            let [d1,p1] = nc.time.split('/'); let pp1 = p1.split(',');
            for(let oc of myCourses) {
                if(!oc.time) continue;
                let [d2,p2] = oc.time.split('/'); let pp2 = p2.split(',');
                if(d1 === d2 && pp1.some(p => pp2.includes(p))) return oc.name;
            }
            return null;
        }

        // --- è·æ¶¯ ---
        function selectTrack(t) { selectedTrack=t; document.querySelectorAll('.radio-card').forEach(x=>x.classList.remove('selected')); document.getElementById('track-'+t).classList.add('selected'); }
        async function saveCareer() {
            if(!selectedTrack) return alert("è«‹é¸æ“‡æ–¹å‘");
            currentUser.interests = Array.from(document.querySelectorAll('.interest-check:checked')).map(x=>x.value);
            await saveMyData();
            alert("è¨­å®šå·²å„²å­˜"); genRec();
        }
        function genRec() {
            if(!selectedTrack) return;
            const kws = selectedTrack==='pilot'?['é£›è¡Œ','ç©ºæ°£','é«”è‚²','è‹±æ–‡']:['è³‡å®‰','ç¶­ä¿®','ç„¡äººæ©Ÿ','ç®¡ç†'];
            const recs = allCourses.filter(c => !myCourses.some(m=>m.id===c.id) && kws.some(k=>c.name.includes(k)));
            const list = document.getElementById('rec-list');
            list.innerHTML = recs.length ? recs.map(c=>`<div style="margin-bottom:8px;">ğŸ‘‰ <b>${c.name}</b> <button class="btn btn-add" style="padding:2px 8px;font-size:12px;" onclick="add('${c.id}')">åŠ é¸</button></div>`).join('') : 'æš«ç„¡æ¨è–¦èª²ç¨‹';
        }

        // --- è¦–è¦ºåŒ–èª²è¡¨ ---
        function renderGrid() {
            const t = document.getElementById('visual-schedule-body'); t.innerHTML='';
            const times = ["08:10", "09:10", "10:10", "11:10", "13:30", "14:30", "15:30", "16:30", "17:30", "19:00"];
            for(let i=1;i<=10;i++) t.innerHTML+=`<tr><td style="background:#f8f9fa;">${i}</td><td id="c1-${i}"></td><td id="c2-${i}"></td><td id="c3-${i}"></td><td id="c4-${i}"></td><td id="c5-${i}"></td></tr>`;
            const dMap={"ä¸€":1,"äºŒ":2,"ä¸‰":3,"å››":4,"äº”":5};
            myCourses.forEach(c => {
                if(!c.time) return;
                let [d,p]=c.time.split('/'); let dy=dMap[d];
                p.split(',').forEach(x => {
                    let el=document.getElementById(`c${dy}-${x}`);
                    if(el) el.innerHTML = `<div class="course-block ${c.isFixed?'block-fixed':'block-normal'}">${c.name}</div>`;
                });
            });
        }
        
        function renderHistory() {
            let h = '';
            myCourses.filter(c=>c.score).forEach(c => h+=`<div style="padding:10px; border-bottom:1px solid #eee;"><b>${c.name}</b>: <span style="color:${c.score<60?'red':'green'}">${c.score}</span></div>`);
            document.getElementById('history-content').innerHTML = h || '<div style="padding:20px;text-align:center;color:#999">å°šç„¡æˆç¸¾</div>';
        }

        function switchTab(t) {
            ['selection','schedule','career','visual','history'].forEach(x=>document.getElementById(x+'-view').style.display='none');
            document.getElementById(t+'-view').style.display='block';
            document.querySelectorAll('.menu-item').forEach(x=>x.classList.remove('active'));
            const map={'selection':0,'schedule':1,'visual':2,'career':3,'history':4};
            if(map[t]!==undefined) document.querySelectorAll('.menu-item')[map[t]].classList.add('active');
        }

        // --- AI Chat ---
        function toggleChat() { const w=document.getElementById('chat-window'); w.style.display=w.style.display==='flex'?'none':'flex'; }
        function sendMessage() {
            const inp=document.getElementById('chat-input'); const txt=inp.value.trim();
            if(!txt)return;
            addMsg(txt,'user'); inp.value='';
            setTimeout(()=>addMsg(getAIResponse(txt),'ai'), 600);
        }
        function addMsg(txt, type) {
            const b=document.getElementById('chat-body');
            b.innerHTML+=`<div class="msg msg-${type}">${txt}</div>`;
            b.scrollTop=b.scrollHeight;
        }
        function getAIResponse(q) {
            if(q.includes('è¡å ‚')) return "å¦‚æœè¡å ‚ï¼Œå¿…é ˆå…ˆé€€æ‰åŸæœ¬çš„èª²æ‰èƒ½åŠ é¸å–”ï¼";
            if(q.includes('å¿…ä¿®')) return "ç­å®šå¿…ä¿®æ˜¯å¼·åˆ¶çŒæª”çš„ï¼Œç„¡æ³•é€€é¸ã€‚";
            if(q.includes('é£›è¡Œ')) return "æƒ³é£›å—ï¼Ÿå»ºè­°å¤šä¿®ç©ºæ°£å‹•åŠ›å­¸èˆ‡è‹±æ–‡ï¼";
            if(q.includes('åœ°å‹¤')) return "åœ°å‹¤å¾ˆé‡è¦ï¼è³‡å®‰èˆ‡ç„¡äººæ©Ÿæ˜¯ç¾åœ¨çš„è¶¨å‹¢ã€‚";
            if(q.includes('ä½ å¥½')) return "ä½ å¥½ï¼æˆ‘æ˜¯ç©ºè»å®˜æ ¡é¸èª²å°å¹«æ‰‹ âœˆï¸";
            return "é€™å€‹å•é¡Œå»ºè­°è©¢å•æ•™å‹™è™•èª²å‹™çµ„å–”ï¼";
        }
    </script>
</body>
</html>





